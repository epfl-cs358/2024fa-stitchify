{"ast":null,"code":"import React,{useEffect}from\"react\";const PatternDownload=_ref=>{let{pattern}=_ref;useEffect(()=>{if(pattern){downloadPattern(pattern);}},[pattern]);const sendToWemos=async content=>{try{const lines=content.split(\"\\n\");for(const line of lines){const response=await fetch(\"http://192.168.1.100/send\",{// Replace with your Wemos IP\nmethod:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({item:line})});if(!response.ok){throw new Error(\"Failed to send data to Wemos for line: \".concat(line));}}}catch(error){console.error(\"Error sending to Wemos:\",error);alert(\"Unable to send the data to Wemos. Please try again.\");}};const downloadPattern=async patternName=>{try{const fileMap={\"Pattern 1\":\"pattern1.txt\",\"Pattern 2\":\"pattern2.txt\",\"Pattern 3\":\"pattern3.txt\"};const fileName=fileMap[patternName];if(!fileName){throw new Error(\"No file found for \".concat(patternName));}const response=await fetch(\"/\".concat(fileName));if(!response.ok){throw new Error(\"Failed to fetch \".concat(fileName));}const content=await response.text();await sendToWemos(content);const file=new Blob([content],{type:\"text/plain\"});const link=document.createElement(\"a\");link.href=URL.createObjectURL(file);link.download=fileName;document.body.appendChild(link);link.click();document.body.removeChild(link);URL.revokeObjectURL(link.href);}catch(error){console.error(\"Download error:\",error);alert(\"Unable to download \".concat(pattern,\". Please try again.\"));}};return null;};export default PatternDownload;","map":{"version":3,"names":["React","useEffect","PatternDownload","_ref","pattern","downloadPattern","sendToWemos","content","lines","split","line","response","fetch","method","headers","body","JSON","stringify","item","ok","Error","concat","error","console","alert","patternName","fileMap","fileName","text","file","Blob","type","link","document","createElement","href","URL","createObjectURL","download","appendChild","click","removeChild","revokeObjectURL"],"sources":["/Users/bogdancirje/Desktop/webapp/src/pages/components/PatternDownload.js"],"sourcesContent":["import React, { useEffect } from \"react\";\n\nconst PatternDownload = ({ pattern }) => {\n  useEffect(() => {\n    if (pattern) {\n      downloadPattern(pattern);\n    }\n  }, [pattern]);\n\n  const sendToWemos = async (content) => {\n    try {\n      const lines = content.split(\"\\n\");\n      for (const line of lines) {\n        const response = await fetch(\"http://192.168.1.100/send\", {\n          // Replace with your Wemos IP\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({ item: line }),\n        });\n\n        if (!response.ok) {\n          throw new Error(`Failed to send data to Wemos for line: ${line}`);\n        }\n      }\n    } catch (error) {\n      console.error(\"Error sending to Wemos:\", error);\n      alert(`Unable to send the data to Wemos. Please try again.`);\n    }\n  };\n\n  const downloadPattern = async (patternName) => {\n    try {\n      const fileMap = {\n        \"Pattern 1\": \"pattern1.txt\",\n        \"Pattern 2\": \"pattern2.txt\",\n        \"Pattern 3\": \"pattern3.txt\",\n      };\n\n      const fileName = fileMap[patternName];\n\n      if (!fileName) {\n        throw new Error(`No file found for ${patternName}`);\n      }\n\n      const response = await fetch(`/${fileName}`);\n\n      if (!response.ok) {\n        throw new Error(`Failed to fetch ${fileName}`);\n      }\n\n      const content = await response.text();\n\n      await sendToWemos(content);\n\n      const file = new Blob([content], { type: \"text/plain\" });\n\n      const link = document.createElement(\"a\");\n      link.href = URL.createObjectURL(file);\n      link.download = fileName;\n\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n\n      URL.revokeObjectURL(link.href);\n    } catch (error) {\n      console.error(\"Download error:\", error);\n      alert(`Unable to download ${pattern}. Please try again.`);\n    }\n  };\n\n  return null;\n};\n\nexport default PatternDownload;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}